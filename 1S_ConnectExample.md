Пример 
======

Пример кода для авторизации и создания контекста работы в системе
Диадок:

 

Функция загружает внешнюю компоненту, авторизуется на сервере Диадок,
получает контекст организации и в случае успешного выполнения всех
необходимых действий - возвращает объект
[Organization](1S_Organization_Desc)


            Функция ВернутьКонтекстРаботыВДиадоке()

              //Загрузка внешней компоненты
              ИмяФайла = "C:\Temp\AddInDiadocAPI.dll";
              Попытка
                ЗагрузитьВнешнююКомпоненту(ИмяФайла);
              Исключение
                ВызватьИсключение("Ошибка загрузки внешней компоненты: " + ОписаниеОшибки());
              КонецПопытки;

              //Создание объекта DiadocInvoiceAPI
              ДиадокАПИ_ = Новый("AddIn.DiadocInvoiceAPI");
              ДиадокАПИ  = ДиадокАпи_.CreateObject();

              //Задаем параметры подлючения к серверу
              ДиадокАпи.ApiClientId = КлючРазработчика;
              ДиадокАпи.ServerUrl   = "https://diadoc-api.kontur.ru:443";

              //Получение списка сертификатов
              Certificates = ДиадокАПИ.GetPersonalCertificates();
              Если Certificates.Count() > 0 Тогда

                Thumbprint = Certificates.GetItem(0).Thumbprint;
                ДиадокСоединение = ДиадокАПИ.CreateConnectionByCertificate(Thumbprint);

                OrganizationList = ДиадокСоединение.GetOrganizationList();
                Если OrganizationList.Count() > 0 Тогда
                  Organization = OrganizationList.GetItem(0);
                  Возврат Organization.Name;
                Иначе
                  ВызватьИсключение("Нет доступных организаций");
                КонецЕсли;

              Иначе
                ВызватьИсключение("Нет доступных сертификатов");
              КонецЕсли;

            КонецФункции;

          
